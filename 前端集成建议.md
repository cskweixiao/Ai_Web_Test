# ğŸ¨ ç¼“å­˜ç»Ÿè®¡å‰ç«¯é›†æˆå»ºè®®

## æ¦‚è¿°

ä¸ºäº†è®©ç”¨æˆ·æ›´ç›´è§‚åœ°çœ‹åˆ°AIä¼˜åŒ–æ•ˆæœï¼Œå»ºè®®åœ¨å‰ç«¯æ·»åŠ ç¼“å­˜ç»Ÿè®¡å±•ç¤ºé¡µé¢ã€‚

## ğŸ“ æ¨èä½ç½®

### é€‰é¡¹1ï¼šç³»ç»Ÿè®¾ç½®é¡µé¢ï¼ˆæ¨èï¼‰

åœ¨ç°æœ‰çš„"ç³»ç»Ÿè®¾ç½®"æˆ–"LLMé…ç½®"é¡µé¢ä¸­æ·»åŠ ä¸€ä¸ª"ç¼“å­˜ç»Ÿè®¡"Tabï¼š

```
ç³»ç»Ÿè®¾ç½®
â”œâ”€â”€ LLMé…ç½®
â”œâ”€â”€ ç¼“å­˜ç»Ÿè®¡ â† æ–°å¢
â”œâ”€â”€ å…¶ä»–è®¾ç½®
```

### é€‰é¡¹2ï¼šç‹¬ç«‹é¡µé¢

åˆ›å»ºç‹¬ç«‹çš„"æ€§èƒ½ç›‘æ§"é¡µé¢ï¼ŒåŒ…å«ç¼“å­˜ç»Ÿè®¡ï¼š

```
å¯¼èˆªæ 
â”œâ”€â”€ æµ‹è¯•ç”¨ä¾‹
â”œâ”€â”€ æµ‹è¯•è®¡åˆ’
â”œâ”€â”€ æ€§èƒ½ç›‘æ§ â† æ–°å¢
    â”œâ”€â”€ ç¼“å­˜ç»Ÿè®¡
    â”œâ”€â”€ æ‰§è¡Œé€Ÿåº¦
    â””â”€â”€ APIè°ƒç”¨ç»Ÿè®¡
```

## ğŸ¯ UIç»„ä»¶è®¾è®¡

### 1. æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡

```tsx
<Row gutter={16}>
  <Col span={6}>
    <Card>
      <Statistic
        title="ç¼“å­˜å‘½ä¸­ç‡"
        value={70.5}
        suffix="%"
        valueStyle={{ color: '#3f8600' }}
        prefix={<RiseOutlined />}
      />
    </Card>
  </Col>
  
  <Col span={6}>
    <Card>
      <Statistic
        title="èŠ‚çœAIè°ƒç”¨"
        value={105}
        suffix="æ¬¡"
        prefix={<ApiOutlined />}
      />
    </Card>
  </Col>
  
  <Col span={6}>
    <Card>
      <Statistic
        title="èŠ‚çœè´¹ç”¨"
        value={1.05}
        suffix="å…ƒ"
        prefix={<DollarOutlined />}
      />
    </Card>
  </Col>
  
  <Col span={6}>
    <Card>
      <Statistic
        title="ç¼“å­˜å…ƒç´ "
        value={87}
        suffix="/ 1000"
        prefix={<DatabaseOutlined />}
      />
    </Card>
  </Col>
</Row>
```

### 2. è¶‹åŠ¿å›¾è¡¨

ä½¿ç”¨ ECharts æˆ– Recharts å±•ç¤ºå‘½ä¸­ç‡è¶‹åŠ¿ï¼š

```tsx
<Card title="ç¼“å­˜å‘½ä¸­è¶‹åŠ¿">
  <LineChart data={trendData}>
    <Line type="monotone" dataKey="hitRate" stroke="#8884d8" />
    <XAxis dataKey="time" />
    <YAxis />
    <Tooltip />
  </LineChart>
</Card>
```

### 3. è¯¦ç»†ç»Ÿè®¡è¡¨æ ¼

```tsx
<Table
  columns={[
    { title: 'æŒ‡æ ‡', dataIndex: 'metric' },
    { title: 'æ•°å€¼', dataIndex: 'value' },
    { title: 'è¯´æ˜', dataIndex: 'description' }
  ]}
  dataSource={[
    { metric: 'æ€»è¯·æ±‚', value: '150æ¬¡', description: 'æ‰€æœ‰å…ƒç´ è¯†åˆ«è¯·æ±‚' },
    { metric: 'ç¼“å­˜å‘½ä¸­', value: '105æ¬¡', description: 'ä»ç¼“å­˜è·å–' },
    { metric: 'ç¼“å­˜æœªå‘½ä¸­', value: '45æ¬¡', description: 'éœ€è¦AIè°ƒç”¨' },
    { metric: 'å†…å­˜å ç”¨', value: '45KB', description: 'å½“å‰ç¼“å­˜å¤§å°' }
  ]}
/>
```

### 4. æ“ä½œæŒ‰é’®

```tsx
<Space>
  <Button 
    type="primary" 
    icon={<ReloadOutlined />}
    onClick={handleRefresh}
  >
    åˆ·æ–°ç»Ÿè®¡
  </Button>
  
  <Button 
    icon={<DeleteOutlined />}
    onClick={handleClearCache}
    danger
  >
    æ¸…ç©ºç¼“å­˜
  </Button>
  
  <Button 
    icon={<DownloadOutlined />}
    onClick={handleExportReport}
  >
    å¯¼å‡ºæŠ¥å‘Š
  </Button>
</Space>
```

## ğŸ”Œ APIè°ƒç”¨ç¤ºä¾‹

### è·å–ç»Ÿè®¡æ•°æ®

```typescript
import { useState, useEffect } from 'react';
import { message } from 'antd';

interface CacheStats {
  totalRequests: number;
  cacheHits: number;
  cacheMisses: number;
  hitRate: number;
  totalElements: number;
  memoryUsage: number;
  estimatedSavings: {
    apiCalls: number;
    cost: string;
    time: string;
  };
  status: 'excellent' | 'good' | 'normal';
}

function CacheStatsPage() {
  const [stats, setStats] = useState<CacheStats | null>(null);
  const [loading, setLoading] = useState(false);

  const fetchStats = async () => {
    setLoading(true);
    try {
      const response = await fetch('/api/config/cache/stats');
      const data = await response.json();
      
      if (data.success) {
        setStats(data.data);
      } else {
        message.error('è·å–ç»Ÿè®¡å¤±è´¥');
      }
    } catch (error) {
      message.error('ç½‘ç»œé”™è¯¯');
    } finally {
      setLoading(false);
    }
  };

  const clearCache = async () => {
    try {
      const response = await fetch('/api/config/cache/clear', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' }
      });
      
      const data = await response.json();
      
      if (data.success) {
        message.success('ç¼“å­˜å·²æ¸…ç©º');
        fetchStats(); // åˆ·æ–°ç»Ÿè®¡
      }
    } catch (error) {
      message.error('æ¸…ç©ºå¤±è´¥');
    }
  };

  useEffect(() => {
    fetchStats();
    // æ¯30ç§’è‡ªåŠ¨åˆ·æ–°
    const interval = setInterval(fetchStats, 30000);
    return () => clearInterval(interval);
  }, []);

  return (
    <div>
      {/* UIç»„ä»¶ */}
    </div>
  );
}
```

## ğŸ¨ æ ·å¼å»ºè®®

### çŠ¶æ€é¢œè‰²

æ ¹æ®ç¼“å­˜å‘½ä¸­ç‡æ˜¾ç¤ºä¸åŒé¢œè‰²ï¼š

```typescript
const getStatusColor = (hitRate: number) => {
  if (hitRate >= 60) return '#52c41a'; // ç»¿è‰² - ä¼˜ç§€
  if (hitRate >= 40) return '#faad14'; // æ©™è‰² - è‰¯å¥½
  return '#f5222d'; // çº¢è‰² - éœ€è¦ä¼˜åŒ–
};

const getStatusText = (hitRate: number) => {
  if (hitRate >= 60) return 'ä¼˜ç§€';
  if (hitRate >= 40) return 'è‰¯å¥½';
  return 'éœ€ä¼˜åŒ–';
};
```

### è¿›åº¦æ¡å±•ç¤º

```tsx
<div>
  <div style={{ marginBottom: 8 }}>
    <span>ç¼“å­˜ä½¿ç”¨ç‡</span>
    <span style={{ float: 'right' }}>87 / 1000</span>
  </div>
  <Progress 
    percent={(87 / 1000) * 100} 
    status={87 / 1000 > 0.9 ? 'exception' : 'active'}
    showInfo={false}
  />
</div>
```

## ğŸ“± å“åº”å¼è®¾è®¡

```tsx
// ç§»åŠ¨ç«¯é€‚é…
<Row gutter={[16, 16]}>
  <Col xs={24} sm={12} md={6}>
    {/* å¡ç‰‡å†…å®¹ */}
  </Col>
</Row>
```

## âš¡ æ€§èƒ½ä¼˜åŒ–

### 1. é˜²æŠ–åˆ·æ–°

```typescript
import { debounce } from 'lodash';

const debouncedFetch = debounce(fetchStats, 1000);
```

### 2. ç¼“å­˜æ•°æ®

```typescript
import { useQuery } from 'react-query';

const { data, isLoading } = useQuery(
  'cacheStats',
  fetchStats,
  {
    refetchInterval: 30000, // 30ç§’è‡ªåŠ¨åˆ·æ–°
    staleTime: 10000 // 10ç§’å†…ä½¿ç”¨ç¼“å­˜
  }
);
```

## ğŸ”” ç”¨æˆ·æç¤º

### é¦–æ¬¡è®¿é—®æç¤º

```tsx
<Alert
  message="AIä¼˜åŒ–å·²å¯ç”¨"
  description="ç³»ç»Ÿå·²è‡ªåŠ¨å¯ç”¨æ™ºèƒ½ç¼“å­˜ï¼Œå¯é™ä½70%ä»¥ä¸Šçš„AIè°ƒç”¨æˆæœ¬ã€‚"
  type="success"
  showIcon
  closable
  style={{ marginBottom: 16 }}
/>
```

### ä¼˜åŒ–å»ºè®®

```tsx
{stats.hitRate < 40 && (
  <Alert
    message="ç¼“å­˜å‘½ä¸­ç‡è¾ƒä½"
    description={
      <div>
        <p>å»ºè®®é‡‡å–ä»¥ä¸‹æªæ–½æå‡ç¼“å­˜æ•ˆæœï¼š</p>
        <ul>
          <li>ç»Ÿä¸€å…ƒç´ æè¿°å‘½åè§„èŒƒ</li>
          <li>å¢å¤§ç¼“å­˜å®¹é‡é…ç½®</li>
          <li>å»¶é•¿ç¼“å­˜è¿‡æœŸæ—¶é—´</li>
        </ul>
      </div>
    }
    type="warning"
    showIcon
  />
)}
```

## ğŸ“Š å®Œæ•´ç¤ºä¾‹ä»£ç 

å®Œæ•´çš„Reactç»„ä»¶ç¤ºä¾‹ï¼š

```tsx
import React, { useState, useEffect } from 'react';
import { 
  Card, Row, Col, Statistic, Button, Space, 
  Table, Progress, Alert, message, Spin 
} from 'antd';
import {
  RiseOutlined, ApiOutlined, DollarOutlined,
  DatabaseOutlined, ReloadOutlined, DeleteOutlined
} from '@ant-design/icons';

const CacheStatsPage: React.FC = () => {
  const [stats, setStats] = useState<any>(null);
  const [loading, setLoading] = useState(false);

  const fetchStats = async () => {
    setLoading(true);
    try {
      const response = await fetch('/api/config/cache/stats');
      const data = await response.json();
      if (data.success) {
        setStats(data.data);
      }
    } catch (error) {
      message.error('è·å–ç»Ÿè®¡å¤±è´¥');
    } finally {
      setLoading(false);
    }
  };

  const clearCache = async () => {
    try {
      const response = await fetch('/api/config/cache/clear', {
        method: 'POST'
      });
      const data = await response.json();
      if (data.success) {
        message.success('ç¼“å­˜å·²æ¸…ç©º');
        fetchStats();
      }
    } catch (error) {
      message.error('æ¸…ç©ºå¤±è´¥');
    }
  };

  useEffect(() => {
    fetchStats();
    const interval = setInterval(fetchStats, 30000);
    return () => clearInterval(interval);
  }, []);

  if (loading && !stats) {
    return <Spin size="large" />;
  }

  return (
    <div style={{ padding: 24 }}>
      <Alert
        message="AIä¼˜åŒ–å·²å¯ç”¨"
        description="ç³»ç»Ÿå·²è‡ªåŠ¨å¯ç”¨æ™ºèƒ½ç¼“å­˜ï¼Œå¯é™ä½70%ä»¥ä¸Šçš„AIè°ƒç”¨æˆæœ¬"
        type="success"
        showIcon
        closable
        style={{ marginBottom: 24 }}
      />

      <Row gutter={16} style={{ marginBottom: 24 }}>
        <Col span={6}>
          <Card>
            <Statistic
              title="ç¼“å­˜å‘½ä¸­ç‡"
              value={stats?.hitRate || 0}
              suffix="%"
              valueStyle={{ 
                color: stats?.hitRate >= 60 ? '#3f8600' : '#faad14' 
              }}
              prefix={<RiseOutlined />}
            />
          </Card>
        </Col>
        
        <Col span={6}>
          <Card>
            <Statistic
              title="èŠ‚çœAIè°ƒç”¨"
              value={stats?.cacheHits || 0}
              suffix="æ¬¡"
              prefix={<ApiOutlined />}
            />
          </Card>
        </Col>
        
        <Col span={6}>
          <Card>
            <Statistic
              title="èŠ‚çœè´¹ç”¨"
              value={stats?.estimatedSavings?.cost || '0 å…ƒ'}
              prefix={<DollarOutlined />}
            />
          </Card>
        </Col>
        
        <Col span={6}>
          <Card>
            <Statistic
              title="ç¼“å­˜å…ƒç´ "
              value={`${stats?.totalElements || 0} / 1000`}
              prefix={<DatabaseOutlined />}
            />
          </Card>
        </Col>
      </Row>

      <Card 
        title="ç¼“å­˜ä½¿ç”¨æƒ…å†µ"
        extra={
          <Space>
            <Button 
              icon={<ReloadOutlined />}
              onClick={fetchStats}
              loading={loading}
            >
              åˆ·æ–°
            </Button>
            <Button 
              icon={<DeleteOutlined />}
              onClick={clearCache}
              danger
            >
              æ¸…ç©ºç¼“å­˜
            </Button>
          </Space>
        }
      >
        <div style={{ marginBottom: 16 }}>
          <div style={{ marginBottom: 8 }}>
            <span>ç¼“å­˜å®¹é‡</span>
            <span style={{ float: 'right' }}>
              {stats?.totalElements || 0} / 1000
            </span>
          </div>
          <Progress 
            percent={((stats?.totalElements || 0) / 10)} 
            status={
              (stats?.totalElements || 0) > 900 ? 'exception' : 'active'
            }
          />
        </div>

        <Table
          size="small"
          columns={[
            { title: 'æŒ‡æ ‡', dataIndex: 'metric', width: 150 },
            { title: 'æ•°å€¼', dataIndex: 'value', width: 120 },
            { title: 'è¯´æ˜', dataIndex: 'description' }
          ]}
          dataSource={[
            {
              key: '1',
              metric: 'æ€»è¯·æ±‚',
              value: `${stats?.totalRequests || 0}æ¬¡`,
              description: 'æ‰€æœ‰å…ƒç´ è¯†åˆ«è¯·æ±‚'
            },
            {
              key: '2',
              metric: 'ç¼“å­˜å‘½ä¸­',
              value: `${stats?.cacheHits || 0}æ¬¡`,
              description: 'ä»ç¼“å­˜ç›´æ¥è·å–ï¼Œæ— éœ€AI'
            },
            {
              key: '3',
              metric: 'ç¼“å­˜æœªå‘½ä¸­',
              value: `${stats?.cacheMisses || 0}æ¬¡`,
              description: 'éœ€è¦è°ƒç”¨AIè¿›è¡Œè¯†åˆ«'
            },
            {
              key: '4',
              metric: 'å†…å­˜å ç”¨',
              value: `${stats?.memoryUsage || 0}KB`,
              description: 'å½“å‰ç¼“å­˜å ç”¨å†…å­˜'
            }
          ]}
          pagination={false}
        />
      </Card>
    </div>
  );
};

export default CacheStatsPage;
```

## ğŸš€ å¿«é€Ÿé›†æˆæ­¥éª¤

1. **åˆ›å»ºç»„ä»¶æ–‡ä»¶**ï¼š`src/pages/CacheStats.tsx`
2. **æ·»åŠ è·¯ç”±**ï¼šåœ¨è·¯ç”±é…ç½®ä¸­æ·»åŠ æ–°é¡µé¢
3. **æ·»åŠ èœå•**ï¼šåœ¨å¯¼èˆªèœå•ä¸­æ·»åŠ å…¥å£
4. **æµ‹è¯•éªŒè¯**ï¼šè®¿é—®é¡µé¢éªŒè¯åŠŸèƒ½

é¢„è®¡å·¥ä½œé‡ï¼š**1-2å°æ—¶**

---

ğŸ“… æ›´æ–°æ—¶é—´ï¼š2025-12-23

