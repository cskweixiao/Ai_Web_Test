# TestFlow 系统操作手册

<div align="center">

**版本**: 2.5.0
**更新日期**: 2025-11-11
**适用对象**: 测试工程师、QA团队

</div>

---

## 📋 目录

1. [系统简介](#1-系统简介)
2. [登录与账号管理](#2-登录与账号管理)
3. [AI测试用例生成（核心功能⭐）](#3-ai测试用例生成核心功能)
4. [UI自动化测试执行](#4-ui自动化测试执行)
5. [AI批量修改测试用例](#5-ai批量修改测试用例)
6. [测试用例管理](#6-测试用例管理)
7. [测试套件管理](#7-测试套件管理)
8. [测试报告查看](#8-测试报告查看)
9. [系统设置](#9-系统设置)
10. [常见问题](#10-常见问题)

---

## 1. 系统简介

### 1.1 TestFlow 是什么？

TestFlow 是一个企业级 AI 驱动的自动化测试平台，核心特性包括：

- **🎨 AI测试用例生成**: 从Axure原型自动生成测试用例，效率提升20-50倍
- **🎭 UI自动化测试**: 基于Playwright的浏览器自动化执行
- **🤖 AI批量修改**: 用自然语言描述变更需求，智能更新测试用例
- **📊 实时监控**: WebSocket实时推送测试执行状态
- **🔐 企业级权限**: 完整的用户体系和权限管理

### 1.2 系统访问

- **访问地址**: http://localhost:5173
- **推荐浏览器**: Chrome 90+, Edge 90+, Firefox 88+
- **屏幕分辨率**: 最低 1366x768（推荐 1920x1080）

---

## 2. 登录与账号管理

### 2.1 首次登录

1. 打开浏览器，访问 `http://localhost:5173`
2. 输入默认管理员账号：
   - **用户名**: `admin`
   - **密码**: `admin123`
3. 点击「登录」按钮
4. ⚠️ **强烈建议**: 首次登录后立即修改密码

### 2.2 修改密码

```
导航路径: 右上角头像 → 设置 → 账号安全 → 修改密码
```

1. 输入当前密码
2. 输入新密码（至少8位，包含字母和数字）
3. 确认新密码
4. 点击「保存修改」

### 2.3 "记住我"功能

- 勾选「记住我」后，7天内无需重复登录
- 如需退出，点击右上角「退出登录」
- 退出后Token自动清除，需重新登录

---

## 3. AI测试用例生成（核心功能⭐）

### 3.1 功能概述

**AI测试用例生成器** 是TestFlow的核心功能，可以从Axure原型文件一键生成完整的功能测试用例。

**核心价值**:
- ⏱️ **效率提升**: 10分钟完成2-3天的工作（提升20-50倍）
- 📈 **覆盖率**: 功能覆盖率85-95%，UI/文案覆盖率80-95%
- 🎯 **专业度**: 结合RAG知识库，生成专业级测试用例
- 💰 **成本节省**: 人力成本节省80-90%

---

### 3.2 完整操作流程

#### **步骤 1: 准备Axure原型**

**支持的文件格式**:
- `.html` / `.htm` 格式（Axure RP 8/9/10导出的HTML）
- 文件大小限制: 最大 50MB

**原型质量建议** ✅:
- ✅ 页面结构清晰，命名规范
- ✅ 交互逻辑完整，流程闭环
- ✅ 关键业务规则体现在原型中
- ✅ 使用Axure标准组件

**避免问题** ❌:
- ❌ 原型过于粗糙，缺少细节
- ❌ 页面命名随意（page1, page2...）
- ❌ 交互关系缺失或混乱
- ❌ 大量使用自定义图片

---

#### **步骤 2: 上传原型并生成需求文档**

**2.1 访问AI生成器**

```
导航路径: 功能测试用例 → AI生成器
或直接访问: http://localhost:5173/functional-test-cases/generator
```

**2.2 上传Axure文件**

![上传原型](../screenshots/ai-generator-step1.png)

1. 点击上传区域或拖拽文件到页面
2. 选择Axure导出的HTML文件
3. 等待文件上传（1-10秒，取决于文件大小）
4. 系统自动解析原型结构

**上传进度提示**:
```
✓ 文件上传中... (1-5秒)
✓ 解析页面结构... (3-10秒)
✓ 提取交互逻辑... (5-15秒)
✓ 识别业务流程... (3-8秒)
```

**2.3 生成需求文档**

![生成需求文档](../screenshots/ai-generator-step2.png)

1. 点击「生成需求文档」按钮
2. AI开始分析原型，预计耗时 **30-60秒**
3. 查看AI思考进度：
   ```
   ✓ 解析原型结构
   ⏳ 理解业务逻辑
   ⏳ 生成需求文档
   ```

**2.4 查看并编辑需求文档**

生成的需求文档包含以下章节：

| 章节 | 内容说明 | 重要性 |
|------|---------|--------|
| **系统概述** | 系统功能和目标用户 | ⭐⭐⭐ |
| **功能需求** | 详细的功能点描述 | ⭐⭐⭐⭐⭐ |
| **页面布局与文案校验** 🆕 | UI元素和文案验证点 | ⭐⭐⭐⭐ |
| **业务规则** | 关键业务逻辑和验证规则 | ⭐⭐⭐⭐⭐ |
| **非功能需求** | 性能、安全、兼容性 | ⭐⭐⭐ |

**编辑需求文档**:
- 支持Markdown格式在线编辑
- 可添加/删除章节
- 可调整业务规则描述
- 实时预览效果

**完整性评分**:
```
📊 需求文档质量评分: 92/100
✓ 功能描述完整
✓ 业务规则清晰
⚠️ 建议补充边界条件说明
```

点击「下一步：生成测试用例」

---

#### **步骤 3: 批量生成测试用例**

![生成测试用例](../screenshots/ai-generator-step3.png)

**3.1 智能规划测试批次**

系统会自动将需求拆分为多个测试批次：

```
📦 批次规划（示例）:
├─ 批次 1: 用户登录与注册 (8个功能点)
├─ 批次 2: 商品浏览与搜索 (12个功能点)
├─ 批次 3: 购物车管理 (10个功能点)
├─ 批次 4: 订单提交与支付 (15个功能点)
└─ 批次 5: 页面布局与文案校验 (6-8个UI/文案验证点) 🆕
```

**3.2 启动批量生成**

1. 点击「开始生成测试用例」
2. 系统逐批次生成测试用例
3. 查看实时进度：
   ```
   正在生成批次 2/5 (进度: 40%)
   ✓ 批次 1 已完成 (8个用例)
   ⏳ 批次 2 生成中...
   ⏳ 批次 3 等待中
   ```

**3.3 RAG知识库增强（可选）** 🆕

如果启用了RAG知识库，系统会自动检索相关测试经验：

```
🔍 [RAG模式] 知识库检索中...
✓ 检索到业务规则: 2条
✓ 检索到测试模式: 3条
✓ 检索到易错点: 1条
🎯 使用知识库增强模式生成测试用例
```

**RAG增强效果**:
- 测试覆盖率提升 +15-25%
- 专业准确性提升 +15-20%
- 边界值覆盖提升 +40-55%

---

**3.4 查看生成结果**

生成完成后，查看测试用例列表：

![测试用例预览](../screenshots/ai-generator-result.png)

**每个测试用例包含**:

| 字段 | 说明 | 示例 |
|------|------|------|
| **用例名称** | 简洁描述测试场景 | "测试用户登录功能-正常流程" |
| **优先级** | Critical / High / Medium / Low | High |
| **质量评分** | AI评估质量（0-100） | 95/100 |
| **前置条件** | 执行前的准备工作 | "用户已注册" |
| **测试步骤** | 详细的操作步骤 | 5-10个步骤 |
| **预期结果** | 每步的验证点 | "显示'登录成功'" |
| **标签** | 分类标签 | [登录, 认证, 核心流程] |

**3.5 批量保存到用例库**

1. 勾选要保存的测试用例（支持全选）
2. 点击「保存到用例库」
3. 系统提示：
   ```
   ✓ 成功保存 45 个测试用例
   - 系统: 电商系统
   - 模块: 用户中心
   - 创建时间: 2025-11-11 14:30
   ```

**3.6 单个编辑后保存**

- 点击测试用例卡片右上角「编辑」图标
- 修改用例内容（名称、步骤、断言等）
- 点击「保存修改」
- 单独保存此用例

---

### 3.3 高级功能

#### **3.3.1 自定义系统提示词**

如需调整AI生成逻辑，可自定义系统提示词：

```
导航路径: AI生成器 → 设置 → 系统提示词
```

**示例**:
```
请严格遵循以下规则:
1. 每个测试用例必须包含至少5个测试步骤
2. 优先级High的用例必须覆盖核心业务流程
3. 断言必须具体明确，避免模糊描述
4. 测试数据必须真实可用，避免使用占位符
```

#### **3.3.2 RAG知识库管理** 🆕

**启用RAG知识库**:

```bash
# 1. 启动Qdrant向量数据库
docker run -p 6333:6333 qdrant/qdrant

# 2. 配置Embedding API (.env)
QDRANT_URL=http://localhost:6333
EMBEDDING_PROVIDER=aliyun
EMBEDDING_API_KEY=your_aliyun_api_key
```

**添加测试知识**:

```
导航路径: 知识管理 → 测试知识库 → 添加知识
```

**知识分类**:

| 分类 | 说明 | 示例 |
|------|------|------|
| **业务规则** | 常见业务验证规则 | "金额字段必须大于0" |
| **测试模式** | 成熟的测试设计模式 | "查询条件功能完整测试" |
| **易错点** | 历史缺陷和易遗漏场景 | "特殊字符导致查询失败" |
| **风险场景** | 高风险和安全相关测试 | "SQL注入风险" |

**查看RAG检索日志**:

```bash
# 查看完整RAG检索过程
tail -f logs/server.log | grep "RAG"

# 示例输出:
# ✅ [RAG-Step2] 向量检索完成 (耗时: 245ms)
# 📊 [RAG-Step3] 业务规则: 2条, 测试模式: 3条
# 🎯 [RAG模式] 将使用知识库增强模式生成测试用例
```

---

### 3.4 最佳实践

**✅ 推荐做法**:

1. **原型准备**:
   - 确保原型结构清晰，页面命名规范
   - 关键业务流程完整体现
   - 交互逻辑准确无误

2. **需求编辑**:
   - 仔细审查AI生成的需求文档
   - 补充边界条件和异常场景
   - 明确业务规则和验证点

3. **测试用例审核**:
   - 检查用例质量评分（建议≥80分）
   - 验证测试步骤的可执行性
   - 确认断言的准确性

4. **知识库维护**:
   - 定期更新测试知识库
   - 删除过时的测试模式
   - 补充新的业务规则

**❌ 常见错误**:

1. ❌ 原型过于粗糙，导致生成用例不完整
2. ❌ 不审查直接保存，遗漏关键验证点
3. ❌ 忽略质量评分低的用例
4. ❌ 不维护知识库，导致RAG效果下降

---

## 4. UI自动化测试执行

### 4.1 功能概述

TestFlow 基于 **Playwright** 实现浏览器自动化测试，支持：

- 🌐 Chrome / Firefox / WebKit 多浏览器
- 📡 实时WebSocket状态推送
- 📸 自动截图和视频录制
- 🔄 并发控制和队列管理
- 🎥 实时画面监控

---

### 4.2 执行单个测试用例

#### **4.2.1 快速执行**

```
导航路径: 测试用例管理 → 选择测试用例 → 点击「执行」按钮
```

**执行流程**:

1. **选择执行环境**:
   ```
   环境选择:
   □ 开发环境 (http://dev.example.com)
   □ 测试环境 (http://test.example.com)  ✓ 推荐
   □ 预发布环境 (http://staging.example.com)
   ```

2. **配置执行参数**:
   | 参数 | 说明 | 默认值 |
   |------|------|--------|
   | **浏览器类型** | chromium / firefox / webkit | chromium |
   | **是否可见** | 显示浏览器窗口 | ❌ 无头模式 |
   | **超时时间** | 单步超时（毫秒） | 30000 (30秒) |
   | **失败重试** | 失败后自动重试次数 | 0 |

3. **点击「开始执行」**

---

#### **4.2.2 查看实时执行状态**

**执行监控面板**:

![测试执行监控](../screenshots/test-execution.png)

```
┌─────────────────────────────────────────┐
│ 测试执行中                              │
├─────────────────────────────────────────┤
│ 测试名称: 测试用户登录功能-正常流程     │
│ 执行状态: 运行中 🟢                     │
│ 进度: 3/5 (60%)                         │
│ 已通过: 3步 ✓                           │
│ 已失败: 0步 ✗                           │
│ 执行时间: 00:01:23                      │
└─────────────────────────────────────────┘
```

**实时日志**:

```
[14:30:15] ℹ️ 开始执行测试...
[14:30:16] ✅ 步骤1: 导航到登录页 - 成功
[14:30:18] ✅ 步骤2: 输入用户名 "admin" - 成功
[14:30:19] ✅ 步骤3: 输入密码 "******" - 成功
[14:30:21] ⏳ 步骤4: 点击登录按钮 - 执行中...
```

---

#### **4.2.3 查看测试证据**

测试完成后，查看详细证据：

**4个标签页**:

1. **📝 执行日志**:
   - 完整的步骤执行日志
   - 断言验证结果
   - 错误堆栈（如有失败）

2. **🎥 实时画面**:
   - 浏览器实时视频流（执行中）
   - 支持近全屏查看
   - 自动暂停/恢复

3. **📸 测试证据**:
   - 每步自动截图
   - 关键操作截图
   - 失败时的错误截图

4. **⏳ 队列状态**:
   - 当前队列中的测试
   - 等待执行的测试
   - 并发数控制

---

### 4.3 批量执行测试套件

#### **4.3.1 创建测试套件**

```
导航路径: 测试套件 → 创建套件
```

**套件配置**:

| 字段 | 说明 | 示例 |
|------|------|------|
| **套件名称** | 简洁描述套件目标 | "用户登录注册回归测试" |
| **描述** | 详细说明 | "覆盖登录、注册、密码重置功能" |
| **选择用例** | 从用例库添加 | 10-50个用例 |
| **执行顺序** | 手动排序或按优先级 | ✓ 按优先级 |
| **并发数** | 同时执行的用例数 | 3-6（推荐） |

**添加测试用例**:

```
┌─────────────────────────────────────────┐
│ 可用测试用例                            │
├─────────────────────────────────────────┤
│ ☐ 测试用户登录-正常流程 (High)          │
│ ☐ 测试用户登录-错误密码 (High)          │
│ ☐ 测试用户注册-正常流程 (Critical)      │
│ ☐ 测试密码重置-邮箱验证 (Medium)        │
│ ☐ 测试退出登录 (Low)                    │
└─────────────────────────────────────────┘

✓ 已选择 5 个测试用例
```

---

#### **4.3.2 执行测试套件**

```
导航路径: 测试套件 → 选择套件 → 批量执行
```

**执行配置**:

```
┌─────────────────────────────────────────┐
│ 套件执行配置                            │
├─────────────────────────────────────────┤
│ 环境: 测试环境 ✓                        │
│ 浏览器: Chromium ✓                      │
│ 并发数: 4                               │
│ 失败后: ☐ 继续执行 ☐ 立即停止 ✓        │
│ 重试次数: 0                             │
└─────────────────────────────────────────┘
```

**批量执行进度**:

![套件执行监控](../screenshots/suite-execution.png)

```
┌─────────────────────────────────────────┐
│ 套件: 用户登录注册回归测试              │
├─────────────────────────────────────────┤
│ 总用例数: 50                            │
│ 已完成: 32 (64%)                        │
│ 执行中: 4 🟢                            │
│ 等待中: 14 ⏳                           │
│ 通过: 30 ✓                              │
│ 失败: 2 ✗                               │
│ 执行时间: 00:15:42                      │
└─────────────────────────────────────────┘
```

**实时监控**:

```
[14:45:10] ⏳ 队列中: 14个用例等待执行
[14:45:11] 🟢 正在执行: 用例1, 用例2, 用例3, 用例4
[14:45:45] ✅ 用例1 执行完成 - 通过
[14:45:46] 🟢 开始执行: 用例5
[14:46:12] ✅ 用例2 执行完成 - 通过
[14:46:13] 🟢 开始执行: 用例6
```

---

### 4.4 停止测试执行

#### **4.4.1 停止单个测试**

```
测试运行页面 → 找到执行中的测试 → 点击「停止」按钮
```

**确认提示**:

```
⚠️ 确认停止测试

测试名称: 测试用户登录功能-正常流程
执行进度: 3/5 (60%)

注意事项:
• 测试将被立即终止
• 已执行的步骤结果会保留
• 测试状态将标记为"已取消"
• 浏览器会话将被关闭

[取消]  [确认停止]
```

#### **4.4.2 停止所有测试**

```
测试运行页面 → 点击右上角「停止所有」按钮
```

**批量停止确认**:

```
⚠️ 批量停止所有测试

当前正在运行: 5个测试
队列中等待: 12个测试
总计: 17个测试将被停止

[取消]  [确认停止所有]
```

**停止后日志**:

```
[15:00:10] 🛑 收到停止信号
[15:00:11] 🔄 正在关闭浏览器会话...
[15:00:12] ✅ 已保存执行结果
[15:00:13] ❌ 测试状态: 已取消
```

---

### 4.5 测试结果查看

#### **4.5.1 访问测试运行页面**

```
导航路径: 测试运行 → 选择运行记录
或直接访问: http://localhost:5173/test-runs
```

**测试运行列表**:

| 测试名称 | 状态 | 进度 | 通过步骤 | 失败步骤 | 执行时间 | 操作 |
|---------|------|------|---------|---------|---------|------|
| 测试登录-正常 | ✅ 完成 | 100% | 5/5 | 0 | 00:01:23 | 查看详情 |
| 测试注册-异常 | ❌ 失败 | 60% | 3/5 | 2 | 00:02:15 | 查看详情 |
| 测试购物车 | 🟢 执行中 | 80% | 4/5 | 0 | 00:03:42 | 停止测试 |
| 测试支付流程 | ⏳ 队列中 | 0% | 0/8 | 0 | - | - |

#### **4.5.2 查看详细测试报告**

点击「查看详情」进入详情页：

**测试详情页包含**:

1. **基本信息**:
   ```
   测试名称: 测试用户登录功能-正常流程
   执行环境: 测试环境
   执行人: admin
   开始时间: 2025-11-11 14:30:15
   结束时间: 2025-11-11 14:31:38
   总耗时: 00:01:23
   最终状态: ✅ 通过
   ```

2. **步骤执行详情**:
   ```
   步骤1: 导航到登录页 ✅
     - 操作: navigate(url="http://test.example.com/login")
     - 耗时: 2.3s
     - 截图: screenshot_step1.png

   步骤2: 输入用户名 ✅
     - 操作: fill(selector="#username", value="admin")
     - 耗时: 0.5s
     - 截图: screenshot_step2.png

   步骤3: 点击登录按钮 ✅
     - 操作: click(selector="#login-btn")
     - 耗时: 1.2s
     - 断言: expect(selector=".success-msg", text="登录成功")
     - 截图: screenshot_step3.png
   ```

3. **测试证据**:
   - 📸 每步截图（支持放大查看）
   - 🎥 完整视频回放（如启用）
   - 📄 完整执行日志

4. **失败分析**（如失败）:
   ```
   ❌ 失败原因:
   步骤3: 点击登录按钮 - 断言失败

   预期: 页面显示 "登录成功"
   实际: 页面显示 "用户名或密码错误"

   错误堆栈:
   AssertionError: Expected text "登录成功" but found "用户名或密码错误"
     at step3.click (line 45)
     at executeTest (line 120)

   失败截图: [查看截图]
   ```

---

### 4.6 高级功能

#### **4.6.1 可视化模式（调试）**

开发环境下，可启用浏览器可见模式调试测试：

```bash
# 修改 .env 文件
PLAYWRIGHT_HEADLESS=false

# 或使用可视化命令启动
npm run dev-visible
```

**可见模式优势**:
- ✅ 实时看到浏览器操作
- ✅ 方便调试定位器
- ✅ 验证交互逻辑

#### **4.6.2 并发数控制**

根据服务器性能调整并发数：

```bash
# .env 配置
MAX_CONCURRENT_TESTS=6

# 推荐配置:
# - 8GB内存: 并发数 3-4
# - 16GB内存: 并发数 6-8
# - 32GB内存: 并发数 10-12
```

#### **4.6.3 测试超时配置**

```bash
# 单步超时（默认30秒）
TEST_TIMEOUT=30000

# 整体超时（默认10分钟）
TEST_TIMEOUT=600000
```

---

### 4.7 测试执行最佳实践

**✅ 推荐做法**:

1. **测试环境稳定性**:
   - 确保测试环境稳定可用
   - 避免测试数据污染
   - 定期清理测试数据

2. **合理配置并发数**:
   - 根据服务器性能调整
   - 避免过高并发导致系统负载过重
   - 监控系统资源使用

3. **失败重试策略**:
   - 偶发性失败配置重试1-2次
   - 稳定性差的测试不配置重试
   - 及时修复失败用例

4. **日志和截图**:
   - 开启自动截图
   - 关键操作手动截图
   - 定期清理历史截图

**❌ 常见错误**:

1. ❌ 并发数过高导致测试失败
2. ❌ 不维护测试数据，导致用例失败
3. ❌ 忽略偶发性失败
4. ❌ 不查看失败日志直接重跑

---

## 5. AI批量修改测试用例

### 5.1 功能概述

**AI批量修改引擎** 允许您使用自然语言描述变更需求，AI会自动识别相关测试用例并生成精确的修改提案。

**核心价值**:
- 🚀 **效率**: 数百个用例批量修改，10分钟搞定
- 🎯 **精准**: AI智能匹配相关用例，避免遗漏
- 🔍 **可视化**: 修改前后对比，风险一目了然
- ✅ **可控**: 支持人工编辑和选择性应用

---

### 5.2 完整操作流程

#### **步骤 1: 打开AI批量更新**

```
导航路径: 测试用例管理 → 点击右上角「AI批量更新」按钮
```

#### **步骤 2: 配置筛选条件**

![配置筛选条件](../screenshots/bulk-update-step1.png)

**筛选参数**:

| 参数 | 说明 | 示例 |
|------|------|------|
| **目标系统** | 限定修改范围的系统 | 电商系统 |
| **目标模块** | 限定修改范围的模块 | 用户中心 |
| **标签过滤** | 按标签筛选 | [登录, 注册] |
| **优先级过滤** | 按优先级筛选 | High, Critical |

**变更描述** ⭐ （最重要）:

```
变更描述输入框（至少10个字符）：

将所有登录相关的测试用例中的"点击登录按钮"改为"双击登录按钮"，
因为产品交互方式发生了变化。同时需要更新相关的验证步骤。

✓ 长度符合要求 (62字符)
```

**描述建议** ✅:

1. ✅ 明确说明变更的原因和目标
2. ✅ 描述具体需要修改的内容
3. ✅ 提及可能受影响的测试步骤或验证点
4. ✅ 使用关键词帮助AI更好地匹配相关用例

**示例变更描述**:

```
示例1: 界面元素变更
"系统登录按钮的ID从'#login'改为'#btn-login'，
需要更新所有使用该定位器的测试用例。"

示例2: 业务规则变更
"用户注册密码强度规则调整：
原: 至少6位
新: 至少8位，包含字母和数字
需要更新所有密码验证相关的测试用例。"

示例3: 流程变更
"支付流程新增二次确认步骤，
在点击'确认支付'后需要弹窗再次确认，
所有支付测试用例需要添加该步骤。"
```

---

#### **步骤 3: 生成修改提案**

1. 点击「生成提案」按钮
2. AI开始分析，预计耗时 **20-60秒**
3. 查看分析进度：
   ```
   ⏳ AI正在分析...
   ✓ 筛选相关测试用例 (15个)
   ✓ 理解变更需求
   ✓ 生成修改提案
   ```

**生成完成提示**:

```
✅ AI分析完成

从 120 个测试用例中识别出 15 个相关用例
请审核下方的修改提案，您可以直接编辑AI建议的内容
```

---

#### **步骤 4: 预览和编辑修改提案**

![预览修改提案](../screenshots/bulk-update-step2.png)

**修改提案卡片**:

```
┌────────────────────────────────────────────────┐
│ [✓] 提案 1                      [编辑] [预览]  │
├────────────────────────────────────────────────┤
│ 用例: 测试用户登录功能-正常流程 #1234          │
│ 状态: ✓ 已选择 | 🤖 AI建议                     │
├────────────────────────────────────────────────┤
│ 修改前:                                        │
│ │ 步骤3: 点击登录按钮                          │
│ │ 操作: click(selector="#login")               │
│                                                │
│ 修改后:                                        │
│ │ 步骤3: 双击登录按钮                          │
│ │ 操作: dblclick(selector="#btn-login")        │
└────────────────────────────────────────────────┘
```

**批量操作**:

```
┌─────────────────────────────────────┐
│ 批量操作                            │
├─────────────────────────────────────┤
│ [✓全选]  [✗清空]                    │
│                                     │
│ 已选择: 12 / 15                     │
│ 选择率: 80%                         │
└─────────────────────────────────────┘
```

---

**编辑提案内容**:

1. 点击提案卡片右上角「编辑」按钮
2. 在修改后内容区域直接编辑
3. 点击「保存」保存编辑
4. 用户编辑后会显示「👤 已编辑」标签

**编辑示例**:

```
原AI建议:
步骤3: 双击登录按钮
操作: dblclick(selector="#btn-login")

用户编辑后:
步骤3: 双击登录按钮，等待跳转
操作: dblclick(selector="#btn-login")
断言: expect(url="http://test.example.com/home")

[保存] [取消] [重置为AI建议]
```

**重置为AI建议**:

如果编辑后不满意，可点击「重置」恢复AI原始建议：

```
⚠️ 确认重置

您的编辑内容将被清除，恢复为AI原始建议。

[取消]  [确认重置]
```

---

#### **步骤 5: 应用修改**

1. 勾选要应用的提案（支持部分应用）
2. 点击「应用选中提案 (12)」按钮
3. 系统批量更新测试用例
4. 查看应用结果：

```
✅ 批量更新完成

成功: 12 个用例
失败: 0 个用例

系统将在3秒后自动关闭此窗口...
🔄 用例数据已刷新，请查看最新内容
```

---

### 5.3 高级功能

#### **5.3.1 风险评估**（已简化）

在当前版本中，风险评估功能已简化，系统不再显示风险等级。所有提案默认可安全应用。

#### **5.3.2 版本控制**

系统自动记录每次批量修改的版本：

```
导航路径: 测试用例详情 → 版本历史
```

**版本列表**:

```
版本 3 (当前) - 2025-11-11 15:30
├─ 变更类型: AI批量修改
├─ 变更人: admin
├─ 变更描述: "登录按钮改为双击"
└─ [回滚到此版本]

版本 2 - 2025-11-10 10:20
├─ 变更类型: 手动编辑
├─ 变更人: tester1
└─ [回滚到此版本]
```

#### **5.3.3 批量回滚**

如需撤销批量修改：

```
导航路径: AI批量更新 → 历史会话 → 选择会话 → 回滚
```

**回滚确认**:

```
⚠️ 确认回滚批量修改

会话ID: sess_20251111_1530
变更描述: "登录按钮改为双击"
修改用例数: 12个

回滚后，这些用例将恢复到修改前的状态。

[取消]  [确认回滚]
```

---

### 5.4 最佳实践

**✅ 推荐做法**:

1. **精确的变更描述**:
   - 明确具体的修改内容
   - 说明修改原因
   - 提供上下文信息

2. **合理的筛选条件**:
   - 缩小修改范围，避免误伤
   - 使用标签精准定位
   - 优先级高的用例单独处理

3. **仔细审核提案**:
   - 逐个查看修改对比
   - 验证修改的准确性
   - 人工编辑调整细节

4. **分批次应用**:
   - 先应用少量测试
   - 验证效果后再批量应用
   - 重要用例单独处理

**❌ 常见错误**:

1. ❌ 变更描述模糊不清
2. ❌ 不审核直接应用
3. ❌ 一次性修改过多用例
4. ❌ 不记录修改历史

---

## 6. 测试用例管理

### 6.1 功能概述

测试用例管理提供完整的用例生命周期管理，包括创建、编辑、分类、搜索、导入导出等功能。

---

### 6.2 查看测试用例

```
导航路径: 测试用例管理
或直接访问: http://localhost:5173/test-cases
```

**用例列表视图**:

![测试用例列表](../screenshots/test-cases-list.png)

```
┌────────────────────────────────────────────────┐
│ [筛选] 系统: 全部 ▼ | 模块: 全部 ▼            │
│ [搜索] 🔍 关键词搜索...                        │
│ [新建测试用例] [AI生成器] [导入] [导出]       │
├────────────────────────────────────────────────┤
│                                                │
│ 卡片 1: 测试用户登录功能-正常流程              │
│ ├─ 优先级: High                               │
│ ├─ 系统/模块: 电商系统 / 用户中心              │
│ ├─ 标签: [登录] [认证] [核心流程]             │
│ ├─ 创建时间: 2025-11-11                       │
│ └─ 操作: [编辑] [执行] [复制] [删除]          │
│                                                │
│ 卡片 2: 测试商品添加购物车-正常流程            │
│ ...                                            │
└────────────────────────────────────────────────┘
```

---

### 6.3 创建测试用例

#### **6.3.1 手动创建**

```
导航路径: 测试用例管理 → 新建测试用例
```

**用例表单**:

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| **用例名称** | 文本 | ✓ | 简洁描述测试场景 |
| **所属系统** | 下拉 | ✓ | 选择或新建系统 |
| **所属模块** | 下拉 | ✓ | 选择或新建模块 |
| **优先级** | 单选 | ✓ | Critical/High/Medium/Low |
| **前置条件** | 文本 |  | 执行前的准备工作 |
| **测试步骤** | JSON |  ✓ | 详细的操作步骤（见下方示例） |
| **标签** | 多选 |  | 分类标签 |
| **描述** | 文本 |  | 补充说明 |

**测试步骤格式** (JSON):

```json
[
  {
    "action": "navigate",
    "params": {
      "url": "http://test.example.com/login"
    },
    "description": "导航到登录页"
  },
  {
    "action": "fill",
    "params": {
      "selector": "#username",
      "value": "admin"
    },
    "description": "输入用户名"
  },
  {
    "action": "fill",
    "params": {
      "selector": "#password",
      "value": "admin123"
    },
    "description": "输入密码"
  },
  {
    "action": "click",
    "params": {
      "selector": "#login-btn"
    },
    "description": "点击登录按钮"
  },
  {
    "action": "expect",
    "params": {
      "selector": ".success-msg",
      "condition": "toBeVisible",
      "value": "登录成功"
    },
    "description": "验证登录成功提示"
  }
]
```

**支持的操作类型**:

| 操作 | 说明 | 参数 |
|------|------|------|
| `navigate` | 导航到URL | `url` |
| `click` | 点击元素 | `selector` |
| `dblclick` | 双击元素 | `selector` |
| `fill` | 填充表单 | `selector`, `value` |
| `select` | 选择下拉选项 | `selector`, `value` |
| `check` | 勾选复选框 | `selector` |
| `uncheck` | 取消勾选 | `selector` |
| `hover` | 悬停元素 | `selector` |
| `wait` | 等待时间 | `timeout` |
| `screenshot` | 截图 | `filename` (可选) |
| `expect` | 验证断言 | `selector`, `condition`, `value` |

**断言条件**:

| 条件 | 说明 | 示例 |
|------|------|------|
| `toBeVisible` | 元素可见 | `expect(selector=".success-msg", condition="toBeVisible")` |
| `toHaveText` | 包含文本 | `expect(selector=".title", condition="toHaveText", value="欢迎")` |
| `toHaveValue` | 输入框值 | `expect(selector="#username", condition="toHaveValue", value="admin")` |
| `toBeChecked` | 复选框选中 | `expect(selector="#agree", condition="toBeChecked")` |
| `toHaveURL` | URL匹配 | `expect(condition="toHaveURL", value="http://*/home")` |

---

#### **6.3.2 使用AI生成器创建**

推荐使用 [AI测试用例生成](#3-ai测试用例生成核心功能) 功能，效率提升20-50倍。

---

### 6.4 编辑测试用例

```
导航路径: 测试用例管理 → 选择用例 → 点击「编辑」按钮
```

**编辑操作**:

1. 修改用例信息（名称、优先级、标签等）
2. 调整测试步骤（新增、删除、修改顺序）
3. 更新断言条件
4. 点击「保存」

**注意事项** ⚠️:

- 编辑后会自动创建新版本
- 旧版本会保留在版本历史中
- 可随时回滚到任意历史版本

---

### 6.5 批量操作

#### **6.5.1 批量导出**

```
导航路径: 测试用例管理 → 勾选用例 → 点击「导出」按钮
```

**导出格式**:

- ✅ **JSON格式** (推荐): 完整保留所有信息
- ✅ **Excel格式**: 方便查看和打印
- ✅ **CSV格式**: 兼容性最佳

**导出示例** (JSON):

```json
[
  {
    "id": 1234,
    "name": "测试用户登录功能-正常流程",
    "system": "电商系统",
    "module": "用户中心",
    "priority": "high",
    "precondition": "用户已注册",
    "steps": [...],
    "tags": ["登录", "认证"],
    "createdAt": "2025-11-11T14:30:00Z"
  }
]
```

---

#### **6.5.2 批量导入**

```
导航路径: 测试用例管理 → 点击「导入」按钮
```

**导入步骤**:

1. 准备导入文件（JSON / Excel / CSV）
2. 点击「选择文件」或拖拽文件
3. 预览导入数据
4. 检查数据映射关系
5. 点击「确认导入」

**导入配置**:

```
┌────────────────────────────────────────┐
│ 导入配置                               │
├────────────────────────────────────────┤
│ 文件: testcases.json                   │
│ 用例数量: 50                           │
│ 重复处理: ○ 跳过 ● 覆盖 ○ 重命名      │
│ 系统映射: 自动匹配 ✓                   │
│ 模块映射: 自动匹配 ✓                   │
└────────────────────────────────────────┘

[取消] [确认导入]
```

**导入结果**:

```
✅ 导入完成

成功: 48 个用例
失败: 2 个用例

失败原因:
- 用例"测试xxx": 缺少必填字段"系统"
- 用例"测试yyy": JSON格式错误

[查看导入日志]
```

---

#### **6.5.3 批量删除**

```
导航路径: 测试用例管理 → 勾选用例 → 点击「批量删除」按钮
```

**删除确认**:

```
⚠️ 确认批量删除

您即将删除 5 个测试用例:
- 测试用户登录功能-正常流程
- 测试用户注册功能-正常流程
- ...

⚠️ 注意: 删除操作不可恢复！

[取消] [确认删除]
```

---

### 6.6 高级筛选

**筛选条件**:

```
┌────────────────────────────────────────┐
│ 高级筛选                               │
├────────────────────────────────────────┤
│ 系统: [电商系统] ✓                     │
│ 模块: [用户中心] [商品管理] ✓          │
│ 优先级: [Critical] [High] ✓            │
│ 标签: [登录] [注册] ✓                  │
│ 创建人: [admin] [tester1] ✓            │
│ 创建时间: 2025-11-01 至 2025-11-11 ✓   │
│                                        │
│ [重置筛选] [应用筛选]                   │
└────────────────────────────────────────┘

筛选结果: 找到 15 个测试用例
```

**关键词搜索**:

```
🔍 搜索框

支持搜索:
- 用例名称关键词
- 步骤描述关键词
- 标签名称
- 系统/模块名称

示例: "登录" "验证码" "支付"
```

---

## 7. 测试套件管理

### 7.1 功能概述

测试套件用于组织和批量执行多个相关的测试用例，支持：

- 📦 组合多个测试用例
- 🔄 批量并发执行
- 📊 统一结果报告
- ⏱️ 定时任务执行

---

### 7.2 创建测试套件

```
导航路径: 测试套件 → 创建套件
```

**套件配置**:

```
┌────────────────────────────────────────┐
│ 创建测试套件                           │
├────────────────────────────────────────┤
│ 套件名称: 用户登录注册回归测试 ✓       │
│ 描述: 覆盖登录、注册、密码重置功能     │
│                                        │
│ 选择测试用例:                          │
│ [搜索] 🔍 搜索用例...                  │
│                                        │
│ 可用用例 (120个):                      │
│ ☐ 测试用户登录-正常流程 (High)         │
│ ☐ 测试用户登录-错误密码 (High)         │
│ ☐ 测试用户注册-正常流程 (Critical)     │
│ ☐ 测试密码重置-邮箱验证 (Medium)       │
│ ...                                    │
│                                        │
│ 已选择 (15个):                         │
│ ☑ 测试用户登录-正常流程 [↑] [↓] [✗]   │
│ ☑ 测试用户登录-错误密码 [↑] [↓] [✗]   │
│ ...                                    │
│                                        │
│ 执行配置:                              │
│ 并发数: 4                              │
│ 失败后: ○ 继续执行 ● 立即停止          │
│ 重试次数: 0                            │
│                                        │
│ [取消] [保存套件]                      │
└────────────────────────────────────────┘
```

**套件用例排序**:

- 拖拽调整执行顺序
- 点击 [↑] [↓] 按钮调整
- 或选择「按优先级自动排序」

---

### 7.3 执行测试套件

详见 [4.3 批量执行测试套件](#43-批量执行测试套件)。

---

### 7.4 查看套件执行历史

```
导航路径: 测试套件 → 选择套件 → 执行历史
```

**历史列表**:

| 执行时间 | 状态 | 总用例 | 通过 | 失败 | 耗时 | 操作 |
|---------|------|--------|------|------|------|------|
| 2025-11-11 15:30 | ✅ 完成 | 50 | 48 | 2 | 00:25:42 | 查看报告 |
| 2025-11-10 10:20 | ❌ 失败 | 50 | 35 | 15 | 00:18:30 | 查看报告 |
| 2025-11-09 14:15 | ✅ 完成 | 45 | 45 | 0 | 00:22:10 | 查看报告 |

---

## 8. 测试报告查看

### 8.1 测试运行报告

```
导航路径: 测试运行 → 选择运行记录 → 查看详情
```

详见 [4.5 测试结果查看](#45-测试结果查看)。

---

### 8.2 统计分析报告

```
导航路径: 报告 → 统计分析
```

**报告类型**:

1. **测试趋势分析**:
   - 每日执行数量趋势
   - 通过率趋势
   - 平均执行时间趋势

2. **失败分布分析**:
   - 按系统/模块统计
   - 按优先级统计
   - 按失败原因统计

3. **覆盖率分析**:
   - 功能覆盖率
   - 用例执行覆盖率
   - 代码覆盖率（如集成）

**示例图表**:

```
📊 测试通过率趋势

100% ┤                         ●───●
 90% ┤                   ●───●
 80% ┤             ●───●
 70% ┤       ●───●
 60% ┤ ●───●
     └─────────────────────────────
      11/05  11/06  11/07  11/08  11/09
```

---

### 8.3 导出报告

```
导航路径: 报告 → 统计分析 → 导出报告
```

**导出格式**:

- ✅ **PDF**: 适合打印和分享
- ✅ **Excel**: 适合数据分析
- ✅ **HTML**: 适合在线查看

---

## 9. 系统设置

### 9.1 用户管理（仅管理员）

```
导航路径: 设置 → 用户管理
```

**用户列表**:

| 用户名 | 姓名 | 角色 | 部门 | 状态 | 操作 |
|--------|------|------|------|------|------|
| admin | 管理员 | 超级管理员 | IT部 | 🟢 启用 | 编辑 |
| tester1 | 测试员1 | 测试工程师 | QA部 | 🟢 启用 | 编辑 / 禁用 |
| tester2 | 测试员2 | 测试工程师 | QA部 | 🔴 禁用 | 编辑 / 启用 |

**创建用户**:

```
┌────────────────────────────────────────┐
│ 创建用户                               │
├────────────────────────────────────────┤
│ 用户名: tester3 ✓                      │
│ 姓名: 测试员3 ✓                        │
│ 密码: ●●●●●●●● ✓                      │
│ 角色: 测试工程师 ✓                     │
│ 部门: QA部 ✓                           │
│ 邮箱: tester3@example.com              │
│ 手机: 13800138000                      │
│                                        │
│ 权限配置:                              │
│ ☑ 查看测试用例                         │
│ ☑ 创建/编辑测试用例                    │
│ ☑ 执行测试                             │
│ ☐ 删除测试用例                         │
│ ☐ 用户管理                             │
│                                        │
│ [取消] [创建用户]                      │
└────────────────────────────────────────┘
```

---

### 9.2 AI模型配置 🆕

```
导航路径: 设置 → LLM模型配置
```

**支持的AI模型**:

| 模型 | 提供商 | 特点 | 成本 | 推荐场景 |
|------|--------|------|------|---------|
| GPT-4o | OpenAI | 高性能 | 高 | 复杂用例生成 |
| DeepSeek Chat V3 | DeepSeek | 高性价比 | 低 | 日常测试 |
| Claude Sonnet 4.5 | Anthropic | 长上下文 | 中 | 大规模分析 |
| Gemini 2.5 Flash | Google | 多模态 | 低 | 本地部署 |

**配置步骤**:

1. 选择AI模型
2. 输入API Key
3. 点击「测试连接」
4. 连接成功后点击「保存设置」

**OpenRouter配置**（GPT-4o / DeepSeek / Claude）:

```
┌────────────────────────────────────────┐
│ OpenRouter 配置                        │
├────────────────────────────────────────┤
│ 模型: openai/gpt-4o ▼                  │
│ API Key: sk-or-v1-************** ✓     │
│ Base URL: https://openrouter.ai/api/v1│
│ Temperature: 0.3                       │
│ Max Tokens: 4000                       │
│                                        │
│ [测试连接] [保存设置]                  │
└────────────────────────────────────────┘

✅ 连接测试成功 (响应时间: 1.2s)
```

**本地Gemini配置**:

```
┌────────────────────────────────────────┐
│ Gemini Local 配置                      │
├────────────────────────────────────────┤
│ 模型: gemini-2.0-flash-exp ▼           │
│ API Key: your_local_api_key ✓          │
│ Base URL: http://localhost:3000/v1     │
│                                        │
│ [测试连接] [保存设置]                  │
└────────────────────────────────────────┘

✅ 连接测试成功 (本地模式)
```

---

### 9.3 系统参数配置

```
导航路径: 设置 → 系统参数
```

**参数列表**:

| 参数 | 说明 | 默认值 | 推荐值 |
|------|------|--------|--------|
| **测试超时** | 单个测试最大执行时间（秒） | 600 | 600-1800 |
| **并发数** | 同时执行的测试数量 | 6 | 3-12 |
| **截图保留天数** | 测试截图保留时间 | 30 | 30-90 |
| **日志保留天数** | 执行日志保留时间 | 90 | 90-180 |
| **自动清理** | 是否自动清理历史数据 | 是 | 是 |

---

## 10. 常见问题

### 10.1 登录问题

**Q: 忘记密码怎么办？**

A: 联系管理员重置密码，或使用以下脚本：

```bash
node scripts/reset-password.js username new_password
```

**Q: 提示"Token已过期"？**

A: 重新登录即可，或勾选"记住我"延长有效期。

---

### 10.2 AI生成问题

**Q: AI生成的测试用例质量不高？**

A:
1. 检查Axure原型质量，确保结构清晰
2. 在需求文档阶段补充业务规则
3. 启用RAG知识库增强功能
4. 自定义系统提示词

**Q: 生成速度很慢？**

A:
1. 检查AI模型连接是否稳定
2. 切换到速度更快的模型（如DeepSeek）
3. 减少单批次生成的用例数量
4. 检查代理配置（如需要）

**Q: RAG知识库未生效？**

A:
1. 确认Qdrant服务已启动
2. 检查Embedding API配置
3. 查看日志确认RAG检索过程
4. 补充测试知识到知识库

---

### 10.3 测试执行问题

**Q: 测试执行失败？**

A:
1. 检查测试环境是否可用
2. 验证测试步骤的选择器是否正确
3. 查看详细错误日志和截图
4. 尝试在可视化模式下调试

**Q: 测试执行很慢？**

A:
1. 减少并发数
2. 优化测试步骤，减少不必要的等待
3. 检查网络连接
4. 升级服务器配置

**Q: 无法停止测试？**

A:
1. 等待10秒，系统正在处理停止信号
2. 如长时间无响应，刷新页面重试
3. 联系管理员检查后端服务

---

### 10.4 系统性能问题

**Q: 系统响应慢？**

A:
1. 检查服务器资源使用情况
2. 清理历史测试数据
3. 优化数据库索引
4. 增加服务器内存

**Q: 浏览器崩溃？**

A:
1. 降低测试并发数
2. 增加服务器内存
3. 关闭不必要的浏览器标签页
4. 检查Playwright版本

---

## 附录 A: 快捷键

| 快捷键 | 功能 | 适用页面 |
|--------|------|---------|
| `Ctrl + S` | 保存当前编辑 | 所有编辑页面 |
| `Ctrl + F` | 搜索/筛选 | 列表页面 |
| `Ctrl + N` | 新建用例/套件 | 测试用例、测试套件 |
| `Ctrl + E` | 快速执行 | 测试用例详情 |
| `Esc` | 关闭模态框 | 所有模态框 |

---

## 附录 B: 术语表

| 术语 | 英文 | 说明 |
|------|------|------|
| **测试用例** | Test Case | 一组测试步骤和断言，用于验证特定功能 |
| **测试套件** | Test Suite | 多个测试用例的集合 |
| **测试运行** | Test Run | 测试用例的单次执行记录 |
| **AI生成器** | AI Generator | 从Axure原型生成测试用例的工具 |
| **RAG** | Retrieval-Augmented Generation | 检索增强生成，结合知识库提升AI生成质量 |
| **Playwright** | - | 浏览器自动化测试框架 |
| **WebSocket** | - | 实时双向通信协议 |
| **MCP** | Model Context Protocol | AI模型与工具的标准化协议 |

---

## 附录 C: 支持与反馈

**技术支持**:

- 📧 邮箱: support@testflow.dev
- 🐛 Bug反馈: https://github.com/testflow/testflow/issues
- 📚 在线文档: https://docs.testflow.dev

**反馈渠道**:

- 在系统右下角点击「反馈」按钮
- 提交功能建议和改进意见

---

<div align="center">

**TestFlow - 让自动化测试变得简单而强大！** 🚀

版本 2.5.0 | 最后更新: 2025-11-11

[⬆ 返回顶部](#testflow-系统操作手册)

</div>
