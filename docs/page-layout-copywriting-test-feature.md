# 页面布局与文案校验测试点功能

## 📋 功能概述

在每次生成需求文档时,系统会在各章节前面自动添加一个专门的"**页面布局与文案校验**"章节,用于验证页面的基本呈现是否符合设计要求。相应地,在生成测试用例时,也会为这个章节自动生成针对性的测试点。

---

## 🎯 功能目标

确保测试覆盖以下方面:
- ✅ 页面标题与导航路径的准确性
- ✅ 布局结构的合理性(无遮挡、错位)
- ✅ 字段标签、表格列头的文案一致性
- ✅ 操作按钮的文案、样式、位置
- ✅ 各类提示信息的友好性和准确性
- ✅ 数据展示格式的规范性(日期、金额、状态等)

---

## 📐 需求文档章节结构

### 1. 列表页(list)

生成的需求文档章节顺序:

```markdown
### 1.1 订单管理页面

⚠️ **页面类型：list**

#### 1.1.1 页面布局与文案校验  ← 🆕 新增章节

**必须验证的内容：**
1. **页面标题与导航**: 页面标题文案正确，面包屑导航路径准确
2. **布局结构**: 查询区域、列表区域、按钮区域布局合理，无遮挡或错位
3. **表格列头**: 所有列头文案与原型一致，顺序正确
4. **按钮文案**: 所有操作按钮的文案、位置、样式与原型一致
5. **提示文案**: 空状态提示、加载提示、错误提示等文案友好且准确
6. **字段标签**: 查询条件的标签文案清晰准确，必填项有明显标识

#### 1.1.2 查询条件
| 字段名 | 控件类型 | 必填 | 默认值 | 说明 | 来源 |
...

#### 1.1.3 列表展示字段
| 字段名 | 数据类型 | 格式 | 说明 | 来源 |
...

#### 1.1.4 操作按钮
| 按钮名称 | 按钮类型 | 权限要求 | 触发条件 | 操作说明 | 来源 |
...

#### 1.1.5 业务规则
...
```

### 2. 表单页(form)

```markdown
### 1.1 订单新增页面

⚠️ **页面类型：form**

#### 1.1.1 页面布局与文案校验  ← 🆕 新增章节

**必须验证的内容：**
1. **页面标题与导航**: 页面标题文案正确（如"新增订单"、"编辑订单"），面包屑导航路径准确
2. **布局结构**: 表单区域布局合理，字段分组清晰，按钮位置符合交互规范
3. **字段标签**: 所有字段标签文案准确，必填项有红色星号标识
4. **按钮文案**: 提交/保存/取消等按钮文案与原型一致，主次关系明确
5. **提示文案**: 字段说明、校验提示、操作提示等文案友好且准确
6. **默认值显示**: 有默认值的字段正确显示初始值

#### 1.1.2 表单字段
| 字段名 | 控件类型 | 必填 | 默认值 | 说明 | 来源 |
...

#### 1.1.3 操作按钮
| 按钮名称 | 按钮类型 | 权限要求 | 触发条件 | 操作说明 | 来源 |
...

#### 1.1.4 业务规则
...
```

### 3. 详情页(detail)

```markdown
### 1.1 订单详情页面

⚠️ **页面类型：detail**

#### 1.1.1 页面布局与文案校验  ← 🆕 新增章节

**必须验证的内容：**
1. **页面标题与导航**: 页面标题文案正确（如"订单详情"、"客户详情"），面包屑导航路径准确
2. **布局结构**: 详情区域布局合理，信息分组清晰（如基本信息、详细信息、操作记录等）
3. **字段标签**: 所有字段标签文案准确，与数据对应关系清晰
4. **按钮文案**: 返回/编辑/删除等按钮文案与原型一致
5. **提示文案**: 状态提示、操作提示等文案友好且准确
6. **数据展示格式**: 日期、金额、状态等字段按规定格式展示

#### 1.1.2 详情展示字段
| 字段名 | 数据类型 | 格式 | 说明 | 来源 |
...

#### 1.1.3 操作按钮
| 按钮名称 | 按钮类型 | 权限要求 | 触发条件 | 操作说明 | 来源 |
...

#### 1.1.4 业务规则
...
```

### 4. 混合页/未知页(mixed/unknown)

```markdown
### 1.1 复杂页面

⚠️ **页面类型：mixed**

#### 1.1.1 页面布局与文案校验  ← 🆕 新增章节

**必须验证的内容：**
1. **页面标题与导航**: 页面标题文案正确，面包屑导航路径准确
2. **布局结构**: 各功能区域布局合理，无遮挡或错位
3. **字段与列头**: 所有字段标签、列头文案与原型一致
4. **按钮文案**: 所有操作按钮的文案、位置、样式与原型一致
5. **提示文案**: 各类提示信息文案友好且准确
6. **数据展示格式**: 日期、金额、状态等字段按规定格式展示

#### 1.1.2 查询条件（如果有）
...

#### 1.1.3 列表展示字段（如果有）
...

#### 1.1.4 操作按钮
...

#### 1.1.5 表单字段定义（如果有）
...

#### 1.1.6 业务规则
...
```

---

## 🧪 测试用例生成示例

当AI检测到章节名称为"页面布局与文案校验"时,会自动生成以下类型的测试点:

### 示例1: 列表页布局与文案测试用例

```json
{
  "name": "1.1.1-页面布局与文案校验",
  "testPurpose": "验证订单管理页面的布局、文案、按钮等基础呈现符合设计要求",
  "system": "订单管理系统",
  "module": "订单管理",
  "sectionId": "1.1.1",
  "sectionName": "页面布局与文案校验",
  "priority": "high",
  "tags": ["UI验证", "文案校验", "布局测试"],
  "coverageAreas": "页面标题,布局结构,表格列头,按钮文案,提示文案,字段标签",
  "testPoints": [
    {
      "testPurpose": "验证订单管理页面的布局、文案、按钮等基础呈现符合设计要求",
      "testPoint": "页面标题与面包屑导航验证",
      "steps": "1. 打开订单管理页面\n2. 检查页面标题文案\n3. 检查面包屑导航路径",
      "expectedResult": "页面标题显示为\"订单管理\"\n面包屑路径为: 首页 > 订单管理",
      "riskLevel": "medium"
    },
    {
      "testPurpose": "验证订单管理页面的布局、文案、按钮等基础呈现符合设计要求",
      "testPoint": "查询区域布局验证",
      "steps": "1. 检查查询条件区域位置\n2. 检查各查询字段的排列\n3. 检查查询按钮位置",
      "expectedResult": "查询条件区域在页面顶部\n字段从左到右依次为: 订单编号、客户名称、订单状态、创建日期\n\"查询\"和\"重置\"按钮在查询条件右侧",
      "riskLevel": "low"
    },
    {
      "testPurpose": "验证订单管理页面的布局、文案、按钮等基础呈现符合设计要求",
      "testPoint": "表格列头文案验证",
      "steps": "1. 检查表格所有列头文案\n2. 检查列头顺序",
      "expectedResult": "列头从左到右依次为: 订单编号、客户名称、商品总数量、结算总金额(集采含税采购成本)(元)、结算总金额(集采含税V链供应价)(元)、销售总金额(元)、当前审批节点、当前审批人、当前状态、订单处理状态、申请日期、申请人、商品渠道、操作\n所有列头文案与原型一致",
      "riskLevel": "medium"
    },
    {
      "testPurpose": "验证订单管理页面的布局、文案、按钮等基础呈现符合设计要求",
      "testPoint": "操作按钮文案与样式验证",
      "steps": "1. 检查所有操作按钮文案\n2. 检查按钮样式(主要/次要/危险)\n3. 检查按钮位置",
      "expectedResult": "按钮文案: 查询、重置、新增、编辑、删除、审核、确认下单、详情\n\"查询\"为主要按钮(蓝色)，\"重置\"为次要按钮(灰色)，\"删除\"为危险按钮(红色)\n按钮位置与原型一致",
      "riskLevel": "medium"
    },
    {
      "testPurpose": "验证订单管理页面的布局、文案、按钮等基础呈现符合设计要求",
      "testPoint": "空状态提示文案验证",
      "steps": "1. 确保列表无数据\n2. 检查空状态提示文案\n3. 检查提示图标和样式",
      "expectedResult": "显示友好的空状态提示: \"暂无订单数据，请点击新增按钮创建订单\"\n提示图标和样式符合设计规范",
      "riskLevel": "low"
    },
    {
      "testPurpose": "验证订单管理页面的布局、文案、按钮等基础呈现符合设计要求",
      "testPoint": "查询条件必填标识验证",
      "steps": "1. 检查所有查询条件标签\n2. 确认必填项有红色星号标识",
      "expectedResult": "所有查询条件标签文案清晰\n必填项(如\"订单编号\")标签旁有红色星号标识",
      "riskLevel": "low"
    },
    {
      "testPurpose": "验证订单管理页面的布局、文案、按钮等基础呈现符合设计要求",
      "testPoint": "金额字段格式验证",
      "steps": "1. 查询有金额数据的订单\n2. 检查金额字段的展示格式",
      "expectedResult": "金额字段格式为: 12,345.67 元\n保留两位小数，千位分隔符，单位显示在数字后",
      "riskLevel": "medium"
    }
  ],
  "steps": "1. 打开订单管理页面...",
  "assertions": "页面标题正确...",
  "preconditions": "用户已登录系统，有订单管理权限"
}
```

### 示例2: 表单页布局与文案测试用例

```json
{
  "name": "1.1.1-页面布局与文案校验",
  "testPurpose": "验证订单新增页面的布局、文案、按钮等基础呈现符合设计要求",
  "system": "订单管理系统",
  "module": "订单管理",
  "sectionId": "1.1.1",
  "sectionName": "页面布局与文案校验",
  "priority": "high",
  "tags": ["UI验证", "文案校验", "布局测试"],
  "coverageAreas": "页面标题,布局结构,字段标签,按钮文案,提示文案,默认值显示",
  "testPoints": [
    {
      "testPurpose": "验证订单新增页面的布局、文案、按钮等基础呈现符合设计要求",
      "testPoint": "页面标题与面包屑导航验证",
      "steps": "1. 点击\"新增\"按钮\n2. 打开订单新增页面\n3. 检查页面标题和导航路径",
      "expectedResult": "页面标题显示为\"新增订单\"\n面包屑路径为: 首页 > 订单管理 > 新增订单",
      "riskLevel": "medium"
    },
    {
      "testPurpose": "验证订单新增页面的布局、文案、按钮等基础呈现符合设计要求",
      "testPoint": "表单字段分组布局验证",
      "steps": "1. 检查表单区域的分组\n2. 检查字段排列顺序",
      "expectedResult": "表单分为: 基本信息、商品信息、结算信息三个分组\n每组字段布局整齐，标签与输入框对齐",
      "riskLevel": "low"
    },
    {
      "testPurpose": "验证订单新增页面的布局、文案、按钮等基础呈现符合设计要求",
      "testPoint": "必填项标识验证",
      "steps": "1. 检查所有字段标签\n2. 确认必填项有红色星号",
      "expectedResult": "必填字段(客户名称、商品、数量等)标签前有红色星号\"*\"\n非必填字段无星号标识",
      "riskLevel": "medium"
    },
    {
      "testPurpose": "验证订单新增页面的布局、文案、按钮等基础呈现符合设计要求",
      "testPoint": "按钮文案与主次关系验证",
      "steps": "1. 检查页面底部按钮文案\n2. 检查按钮样式和排列顺序",
      "expectedResult": "按钮文案: \"提交\"、\"保存草稿\"、\"取消\"\n\"提交\"为主要按钮(蓝色)，\"保存草稿\"为次要按钮(灰色)，\"取消\"为次要按钮\n按钮从左到右排列",
      "riskLevel": "medium"
    },
    {
      "testPurpose": "验证订单新增页面的布局、文案、按钮等基础呈现符合设计要求",
      "testPoint": "字段说明提示验证",
      "steps": "1. 检查有说明的字段\n2. 查看提示图标和文案",
      "expectedResult": "复杂字段(如\"结算方式\")旁有\"ⓘ\"图标\n鼠标悬停显示友好的说明文案",
      "riskLevel": "low"
    },
    {
      "testPurpose": "验证订单新增页面的布局、文案、按钮等基础呈现符合设计要求",
      "testPoint": "默认值显示验证",
      "steps": "1. 打开新增页面\n2. 检查有默认值的字段",
      "expectedResult": "\"订单日期\"字段默认显示当前日期\n\"商品渠道\"字段默认显示\"集采\"\n其他有默认值的字段正确显示",
      "riskLevel": "medium"
    }
  ],
  "steps": "1. 点击新增按钮...",
  "assertions": "页面标题正确...",
  "preconditions": "用户已登录系统，有订单新增权限"
}
```

---

## 🔧 技术实现

### 1. 修改需求文档生成AI提示词

**文件**: `server/services/functionalTestCaseAIService.ts`

**位置**: 第437-563行 (不同页面类型的章节模板)

**修改内容**:
- 在每种页面类型的第一个章节添加"页面布局与文案校验"
- 定义该章节的必须验证内容(6个验证点)
- 调整后续章节的编号(1.1.2, 1.1.3, ...)

### 2. 更新测试用例生成AI提示词

**文件**: `server/services/functionalTestCaseAIService.ts`

**位置**:
- 第1033-1041行: systemPrompt中添加特殊章节说明
- 第1085行: userPrompt中添加生成要求

**修改内容**:
- 在systemPrompt中添加"🎨 特殊章节：页面布局与文案校验"说明
- 说明该章节需要生成的6类测试点
- 指定优先级(medium/high)和风险等级(low/medium)
- 在userPrompt中提醒AI识别该章节并生成相应测试点

---

## 📊 预期效果

### 需求文档层面
1. ✅ 每个页面都有明确的"页面布局与文案校验"章节
2. ✅ 章节位于其他功能性章节之前(1.1.1)
3. ✅ 列出6个必须验证的方面
4. ✅ 根据页面类型(list/form/detail)调整验证重点

### 测试用例层面
1. ✅ 自动为"页面布局与文案校验"章节生成测试用例
2. ✅ 测试点覆盖标题、布局、文案、按钮、提示、格式等方面
3. ✅ 测试点数量通常6-8个(根据页面复杂度)
4. ✅ 优先级设置为medium或high
5. ✅ 风险等级设置为low或medium

### 测试覆盖率提升
- 🎯 UI层面覆盖率: 从0% → 80%+
- 🎯 文案准确性验证: 从0% → 100%
- 🎯 布局合理性验证: 从0% → 90%+

---

## 🚀 使用方法

### 步骤1: 上传Axure原型

在"功能测试用例生成器"页面上传Axure HTML + JS文件。

### 步骤2: 解析原型并生成需求文档

系统会自动识别页面类型,并在每个页面的第一个章节生成"页面布局与文案校验"。

### 步骤3: 查看需求文档

打开生成的需求文档,确认每个页面的1.1.1章节是"页面布局与文案校验"。

### 步骤4: 批量生成测试用例

点击"批量生成测试用例"按钮,系统会自动为所有章节(包括"页面布局与文案校验")生成测试用例。

### 步骤5: 查看测试用例

在测试用例列表中,筛选章节ID为"X.X.1"的用例,即为"页面布局与文案校验"的测试用例。

---

## 🎯 验证清单

### 需求文档验证
- [ ] 每个页面的第一个章节是"页面布局与文案校验"
- [ ] 章节编号正确(1.1.1, 1.2.1, 1.3.1, ...)
- [ ] 包含6个"必须验证的内容"
- [ ] 列表页、表单页、详情页的验证内容有差异

### 测试用例验证
- [ ] "页面布局与文案校验"章节自动生成测试用例
- [ ] 测试用例名称格式: "X.X.1-页面布局与文案校验"
- [ ] 包含多个测试点(通常6-8个)
- [ ] 测试点覆盖标题、布局、文案、按钮、提示、格式
- [ ] 优先级为medium或high
- [ ] 风险等级为low或medium
- [ ] testPurpose字段不为空

---

## 📝 示例对比

### 修改前

```markdown
### 1.1 订单管理页面

⚠️ **页面类型：list**

#### 1.1.1 查询条件  ← 直接开始功能性章节
| 字段名 | 控件类型 | 必填 | 默认值 | 说明 | 来源 |
...

#### 1.1.2 列表展示字段
...

#### 1.1.3 操作按钮
...
```

**问题**: 没有专门验证页面基础呈现的测试点,容易遗漏UI/文案问题。

---

### 修改后

```markdown
### 1.1 订单管理页面

⚠️ **页面类型：list**

#### 1.1.1 页面布局与文案校验  ← 🆕 新增专门章节

**必须验证的内容：**
1. **页面标题与导航**: 页面标题文案正确，面包屑导航路径准确
2. **布局结构**: 查询区域、列表区域、按钮区域布局合理，无遮挡或错位
3. **表格列头**: 所有列头文案与原型一致，顺序正确
4. **按钮文案**: 所有操作按钮的文案、位置、样式与原型一致
5. **提示文案**: 空状态提示、加载提示、错误提示等文案友好且准确
6. **字段标签**: 查询条件的标签文案清晰准确，必填项有明显标识

#### 1.1.2 查询条件
| 字段名 | 控件类型 | 必填 | 默认值 | 说明 | 来源 |
...

#### 1.1.3 列表展示字段
...

#### 1.1.4 操作按钮
...
```

**优势**:
- ✅ 明确了UI/文案验证的范围
- ✅ 自动生成相应测试用例
- ✅ 提高测试覆盖率
- ✅ 减少线上UI/文案问题

---

## 🔍 故障排查

### 问题1: 需求文档没有"页面布局与文案校验"章节

**可能原因**:
- AI没有遵循新的提示词模板

**解决方案**:
1. 检查`functionalTestCaseAIService.ts`第437-563行的模板内容
2. 确认AI模型配置正确
3. 重新生成需求文档

---

### 问题2: 测试用例没有为"页面布局与文案校验"章节生成

**可能原因**:
- AI没有识别该章节
- systemPrompt或userPrompt配置错误

**解决方案**:
1. 检查章节名称是否完全匹配"页面布局与文案校验"
2. 检查systemPrompt第1033-1041行的内容
3. 检查userPrompt第1085行的内容
4. 查看后端日志确认AI是否收到正确的提示词

---

### 问题3: 生成的测试点数量过少或过多

**可能原因**:
- AI判断需求复杂度有误

**解决方案**:
1. 检查需求文档章节内容是否完整
2. 调整systemPrompt中的生成规则(第1027-1031行)
3. 在userPrompt中添加具体要求(如"至少生成6个测试点")

---

## 🎓 最佳实践

1. **原型设计阶段**: 确保Axure原型包含完整的页面标题、按钮文案、提示信息
2. **需求文档生成**: 仔细查看"页面布局与文案校验"章节内容,补充遗漏的验证点
3. **测试用例生成**: 批量生成后,优先review布局与文案相关的测试用例
4. **测试执行**: 将"页面布局与文案校验"测试用例安排在功能测试之前执行
5. **缺陷管理**: 对UI/文案问题单独分类,追踪修复率

---

## 📈 ROI分析

### 时间节省
- **需求文档编写**: 节省20-30分钟/页面 (原本需要手动补充UI/文案验证内容)
- **测试用例编写**: 节省30-40分钟/页面 (自动生成6-8个测试点)
- **测试执行**: 节省10-15分钟/页面 (有明确的验证清单)

**总计**: 节省60-85分钟/页面

### 质量提升
- **UI问题发现率**: 提升60%+ (原本容易遗漏的文案、布局问题)
- **需求准确性**: 提升40%+ (明确了UI层面的验证标准)
- **测试覆盖率**: 提升30%+ (新增UI/文案测试维度)

---

## 📚 相关文档

- [智能补全功能修复总结](smart-completion-fixes-summary.md)
- [按钮提取修复文档](button-extraction-fix.md)
- [字段提取修复文档](field-extraction-fix.md)
- [需求文档生成AI提示词](../server/services/functionalTestCaseAIService.ts#L235-L563)
- [测试用例生成AI提示词](../server/services/functionalTestCaseAIService.ts#L1015-L1100)

---

**文档版本**: v1.0
**创建时间**: 2025-11-05
**最后更新**: 2025-11-05
**维护者**: AI Assistant
