# ğŸš€ Ai Web Test AI è‡ªåŠ¨åŒ–æµ‹è¯•å¹³å° - æŠ€æœ¯æ¶æ„æ€»ç»“

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**Ai Web Test** æ˜¯ä¸€ä¸ªåŸºäº AI + MCP + Playwright çš„æ™ºèƒ½åŒ– Web è‡ªåŠ¨åŒ–æµ‹è¯•å¹³å°ï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€æµ‹è¯•ç”¨ä¾‹ç¼–å†™å’Œæ‰§è¡Œã€‚

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ•´ä½“æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ React    â”‚â”€â”€â”€â–¶â”‚  åç«¯ Express   â”‚â”€â”€â”€â–¶â”‚   MCP Client    â”‚â”€â”€â”€â–¶â”‚ Playwright æµè§ˆå™¨â”‚
â”‚   (ç”¨æˆ·ç•Œé¢)     â”‚    â”‚   (APIæœåŠ¡)     â”‚    â”‚  (åè®®è½¬æ¢)     â”‚    â”‚   (è‡ªåŠ¨åŒ–æ‰§è¡Œ)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚                       â”‚
         â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   WebSocket     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   AI è§£æå™¨     â”‚
                        â”‚   (å®æ—¶é€šä¿¡)     â”‚                             â”‚ (è‡ªç„¶è¯­è¨€â†’å‘½ä»¤) â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚                                               â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   æ•°æ®åº“å±‚      â”‚                             â”‚   å¿«ç…§ä¼˜åŒ–      â”‚
                        â”‚ (MySQL+Prisma)  â”‚                             â”‚  (é¡µé¢åˆ†æ)     â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ æ ¸å¿ƒæŠ€æœ¯æ ˆ

### å‰ç«¯æŠ€æœ¯
- **React 18** - ç°ä»£åŒ–å‰ç«¯æ¡†æ¶
- **TypeScript** - ç±»å‹å®‰å…¨çš„JavaScript
- **Vite** - å¿«é€Ÿæ„å»ºå·¥å…·
- **Tailwind CSS** - åŸå­åŒ–CSSæ¡†æ¶
- **Ant Design** - ä¼ä¸šçº§UIç»„ä»¶åº“
- **Zustand** - è½»é‡çº§çŠ¶æ€ç®¡ç†
- **React Router** - å‰ç«¯è·¯ç”±
- **Framer Motion** - åŠ¨ç”»åº“

### åç«¯æŠ€æœ¯
- **Node.js + Express** - æœåŠ¡å™¨æ¡†æ¶
- **TypeScript** - ç±»å‹å®‰å…¨å¼€å‘
- **WebSocket (ws)** - å®æ—¶é€šä¿¡
- **Prisma** - ç°ä»£åŒ–ORM
- **MySQL** - å…³ç³»å‹æ•°æ®åº“
- **Bull** - ä»»åŠ¡é˜Ÿåˆ—ç®¡ç†
- **CORS** - è·¨åŸŸæ”¯æŒ

### è‡ªåŠ¨åŒ–æµ‹è¯•æŠ€æœ¯
- **Playwright** - æµè§ˆå™¨è‡ªåŠ¨åŒ–å¼•æ“
- **MCP (Model Context Protocol)** - æ ‡å‡†åŒ–åè®®
- **@playwright/mcp** - Playwright MCPæœåŠ¡å™¨

### AIæŠ€æœ¯
- **OpenRouter API** - å¤šæ¨¡å‹AIæ¥å£
- **GPT-4o** - é»˜è®¤AIæ¨¡å‹
- **è‡ªç„¶è¯­è¨€å¤„ç†** - æµ‹è¯•ç”¨ä¾‹è§£æ
- **æ™ºèƒ½å…ƒç´ å®šä½** - é¡µé¢å…ƒç´ åŒ¹é…

## ğŸ”§ æ ¸å¿ƒå®ç°æœºåˆ¶

### 1. **AIé©±åŠ¨çš„æµ‹è¯•è§£æ**
```typescript
// AIè§£æå™¨ (aiParser.ts)
class AITestParser {
  // å°†è‡ªç„¶è¯­è¨€è½¬æ¢ä¸ºMCPå‘½ä»¤
  async parseNextStep(description: string, snapshot: any): Promise<TestStep>
  
  // æ™ºèƒ½å…ƒç´ åŒ¹é…
  private extractPageElements(snapshot: string): PageElement[]
  
  // æ„å»ºAIæç¤ºè¯
  private buildOperationUserPrompt(step: string, elements: PageElement[]): string
}
```

### 2. **MCPåè®®é›†æˆ**
```typescript
// MCPå®¢æˆ·ç«¯ (mcpClient.ts)
class PlaywrightMcpClient {
  // è¿æ¥Playwright MCPæœåŠ¡å™¨
  async initialize(): Promise<void>
  
  // æ‰§è¡Œæµè§ˆå™¨æ“ä½œ
  async callTool(command: MCPCommand): Promise<any>
  
  // è·å–é¡µé¢å¿«ç…§
  async getSnapshot(): Promise<string>
}
```

### 3. **æµ‹è¯•æ‰§è¡Œå¼•æ“**
```typescript
// æµ‹è¯•æ‰§è¡ŒæœåŠ¡ (testExecution.ts)
class TestExecutionService {
  // æ‰§è¡Œå®Œæ•´æµ‹è¯•ç”¨ä¾‹
  async executeTest(testCase: TestCase): Promise<TestResult>
  
  // æ­¥éª¤çº§æ‰§è¡Œæ§åˆ¶
  private async executeStepWithRetry(step: TestStep): Promise<ExecutionResult>
  
  // æ™ºèƒ½é‡è¯•æœºåˆ¶
  private async executeMcpCommandWithStrategy(step: TestStep, strategy: string)
}
```

### 4. **å®æ—¶é€šä¿¡ç³»ç»Ÿ**
```typescript
// WebSocketç®¡ç† (websocket.ts)
class WebSocketManager {
  // å¹¿æ’­æµ‹è¯•çŠ¶æ€æ›´æ–°
  broadcast(event: string, data: any): void
  
  // å®¢æˆ·ç«¯è¿æ¥ç®¡ç†
  handleConnection(ws: WebSocket): void
}
```

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒæ•°æ®æ¨¡å‹
```sql
-- æµ‹è¯•ç”¨ä¾‹è¡¨
test_cases (id, name, description, steps, assertions, created_at)

-- æµ‹è¯•è¿è¡Œè¡¨  
test_runs (id, case_id, status, started_at, completed_at)

-- æµ‹è¯•ç»“æœè¡¨
test_run_results (id, run_id, step_index, status, screenshot_path)

-- ç”¨æˆ·ç®¡ç†è¡¨
users (id, username, email, role)

-- AIè¿è¡Œè®°å½•è¡¨
ai_runs (id, prompt_id, token_used, cost_usd, executed_at)
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. **è‡ªç„¶è¯­è¨€æµ‹è¯•ç¼–å†™**
- ç”¨æˆ·ç”¨ä¸­æ–‡æè¿°æµ‹è¯•æ­¥éª¤
- AIè‡ªåŠ¨è§£æä¸ºå¯æ‰§è¡Œå‘½ä»¤
- æ”¯æŒå¤æ‚äº¤äº’åœºæ™¯

### 2. **æ™ºèƒ½å…ƒç´ å®šä½**
- é¡µé¢å¿«ç…§åˆ†æ
- AIé©±åŠ¨çš„å…ƒç´ åŒ¹é…
- å¤šç­–ç•¥é‡è¯•æœºåˆ¶

### 3. **å®æ—¶æ‰§è¡Œç›‘æ§**
- WebSocketå®æ—¶çŠ¶æ€æ›´æ–°
- æ­¥éª¤çº§æ‰§è¡Œæ—¥å¿—
- è‡ªåŠ¨æˆªå›¾ä¿å­˜

### 4. **å¤šçº§ä¸‹æ‹‰æ”¯æŒ**
- çº§è”é€‰æ‹©è‡ªåŠ¨ç­‰å¾…
- åŠ¨æ€å…ƒç´ è¯†åˆ«
- æ™ºèƒ½é¡µé¢çŠ¶æ€æ£€æµ‹

### 5. **æ»šåŠ¨æ“ä½œæ”¯æŒ**
- 6ç§æ»šåŠ¨æ“ä½œç±»å‹
- æ™ºèƒ½æ»šåŠ¨è·ç¦»è®¡ç®—
- å…ƒç´ å¯è§æ€§ç¡®ä¿

## ğŸš€ éƒ¨ç½²æ¶æ„

### å¼€å‘ç¯å¢ƒ
```bash
# å‰ç«¯å¼€å‘æœåŠ¡å™¨ (Vite)
npm run dev:frontend  # localhost:5173

# åç«¯å¼€å‘æœåŠ¡å™¨ (Express)  
npm run dev:server    # localhost:3001

# æ•°æ®åº“ (MySQL)
# localhost:3306
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
# æ„å»ºå‰ç«¯
npm run build

# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm start

# æ•°æ®åº“è¿ç§»
npx prisma migrate deploy
```

## ğŸ”„ å·¥ä½œæµç¨‹

### æµ‹è¯•æ‰§è¡Œæµç¨‹
1. **ç”¨æˆ·è¾“å…¥** - è‡ªç„¶è¯­è¨€æµ‹è¯•æè¿°
2. **AIè§£æ** - è½¬æ¢ä¸ºç»“æ„åŒ–æ­¥éª¤
3. **MCPè½¬æ¢** - ç”ŸæˆPlaywrightå‘½ä»¤
4. **æµè§ˆå™¨æ‰§è¡Œ** - è‡ªåŠ¨åŒ–æ“ä½œæ‰§è¡Œ
5. **ç»“æœæ”¶é›†** - æˆªå›¾ã€æ—¥å¿—ã€çŠ¶æ€
6. **å®æ—¶åé¦ˆ** - WebSocketæ¨é€æ›´æ–°

### æ•°æ®æµå‘
```
ç”¨æˆ·ç•Œé¢ â†’ APIè¯·æ±‚ â†’ æµ‹è¯•æœåŠ¡ â†’ AIè§£æ â†’ MCPå‘½ä»¤ â†’ Playwright â†’ æµè§ˆå™¨
    â†‘                                                                    â†“
WebSocket â† çŠ¶æ€æ›´æ–° â† æ‰§è¡Œç»“æœ â† æˆªå›¾æ—¥å¿— â† æ“ä½œåé¦ˆ â† é¡µé¢å“åº” â†â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ’¡ æŠ€æœ¯äº®ç‚¹

1. **AIé©±åŠ¨** - è‡ªç„¶è¯­è¨€ç›´æ¥è½¬æ¢ä¸ºè‡ªåŠ¨åŒ–æµ‹è¯•
2. **æ ‡å‡†åè®®** - åŸºäºMCPåè®®ï¼Œæ˜“äºæ‰©å±•
3. **å®æ—¶åé¦ˆ** - WebSocketå®ç°æ¯«ç§’çº§çŠ¶æ€åŒæ­¥
4. **æ™ºèƒ½é‡è¯•** - å¤šç­–ç•¥å®¹é”™æœºåˆ¶
5. **æ¨¡å—åŒ–è®¾è®¡** - é«˜å†…èšä½è€¦åˆçš„æ¶æ„
6. **ç±»å‹å®‰å…¨** - å…¨æ ˆTypeScriptå¼€å‘
7. **ç°ä»£åŒ–UI** - å“åº”å¼è®¾è®¡ï¼Œç”¨æˆ·ä½“éªŒä¼˜ç§€

è¿™æ˜¯ä¸€ä¸ªé›†æˆäº†æœ€æ–°AIæŠ€æœ¯ã€ç°ä»£Webå¼€å‘æ¡†æ¶å’Œæ ‡å‡†åŒ–åè®®çš„åˆ›æ–°å‹è‡ªåŠ¨åŒ–æµ‹è¯•å¹³å°ï¼